From 074f18ff8c1723b0fb5b829a8975788d7e5078be Mon Sep 17 00:00:00 2001
From: Florin Postolache <florin.postolache80@gmail.com>
Date: Tue, 11 Oct 2022 09:01:24 +0300
Subject: [PATCH] Modify dirname source to work with uktest

---
 src/functional/dirname.c | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)

diff --git a/src/functional/dirname.c b/src/functional/dirname.c
index 766d467..55c01f5 100644
--- a/src/functional/dirname.c
+++ b/src/functional/dirname.c
@@ -1,20 +1,22 @@
 #include <stdlib.h>
 #include <string.h>
 #include <libgen.h>
-#include "test.h"
+#include <uk/test.h>//"test.h"
 
 #define T(path, want) \
 { \
 	char tmp[100]; \
 	char *got = dirname(strcpy(tmp, path)); \
-	if (strcmp(want, got) != 0) \
-		t_error("dirname(\"%s\") got \"%s\" want \"%s\"\n", path, got, want); \
+	UK_TEST_EXPECT_ZERO(strcmp(want, got)); \
 }
+//	if (strcmp(want, got) != 0) \
+//		t_error("dirname(\"%s\") got \"%s\" want \"%s\"\n", path, got, want); \
+//}
 
-int main()
+UK_TESTCASE(uk_libc_testsuite, dirname_tests)//int main()
 {
-	if (strcmp(dirname(0), ".") != 0)
-		t_error("dirname(0) returned \"%s\"; expected \".\"\n", dirname(0));
+UK_TEST_EXPECT_ZERO(strcmp(dirname(0), "."));//	if (strcmp(dirname(0), ".") != 0)
+//		t_error("dirname(0) returned \"%s\"; expected \".\"\n", dirname(0));
 	T("", ".");
 	T("/usr/lib", "/usr");
 	T("/usr/", "/");
@@ -24,5 +26,5 @@ int main()
 	T("///", "/");
 	T(".", ".");
 	T("..", ".");
-	return t_status;
+//	return t_status;
 }
-- 
2.25.1

