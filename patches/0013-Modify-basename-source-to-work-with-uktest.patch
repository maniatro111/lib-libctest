From e4738c78b8ac61418d2ecf46eecbe416e7a5f900 Mon Sep 17 00:00:00 2001
From: Florin Postolache <florin.postolache80@gmail.com>
Date: Tue, 11 Oct 2022 08:10:25 +0300
Subject: [PATCH] Modify basename source to work with uktest

---
 src/functional/basename.c | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)

diff --git a/src/functional/basename.c b/src/functional/basename.c
index 96a470e..28c601f 100644
--- a/src/functional/basename.c
+++ b/src/functional/basename.c
@@ -1,20 +1,22 @@
 #include <stdlib.h>
 #include <string.h>
 #include <libgen.h>
-#include "test.h"
+#include <uk/test.h>//"test.h"
 
 #define T(path, want) \
 { \
 	char tmp[100]; \
 	char *got = basename(strcpy(tmp, path)); \
-	if (strcmp(want, got) != 0) \
-		t_error("basename(\"%s\") got \"%s\" want \"%s\"\n", path, got, want); \
+	UK_TEST_EXPECT_ZERO(strcmp(want, got)); \
 }
+//	if (strcmp(want, got) != 0) 
+//		t_error("basename(\"%s\") got \"%s\" want \"%s\"\n", path, got, want); 
+//}
 
-int main()
+UK_TESTCASE(uk_libc_testsuite, basename_tests)//int main()
 {
-	if (strcmp(basename(0), ".") != 0)
-		t_error("basename(0) returned \"%s\"; expected \".\"\n", basename(0));
+	UK_TEST_EXPECT_ZERO(strcmp(basename(0), "."));//if (strcmp(basename(0), ".") != 0)
+	//	t_error("basename(0) returned \"%s\"; expected \".\"\n", basename(0));
 	T("", ".");
 	T("/usr/lib", "lib");
 	T("/usr/", "usr");
@@ -24,5 +26,5 @@ int main()
 	T("//usr//lib//", "lib");
 	T(".", ".");
 	T("..", "..");
-	return t_status;
+//	return t_status;
 }
-- 
2.25.1

