From fa20fca49f7c2f9362ee2c5b9bc15d7a3fc73491 Mon Sep 17 00:00:00 2001
From: Florin Postolache <florin.postolache80@gmail.com>
Date: Fri, 28 Oct 2022 12:41:47 +0300
Subject: [PATCH] Modify regex-backref-0 source to work with uktest

Signed-off-by: Florin Postolache <florin.postolache80@gmail.com>
---
 src/regression/regex-backref-0.c | 11 ++++-------
 1 file changed, 4 insertions(+), 7 deletions(-)

diff --git a/src/regression/regex-backref-0.c b/src/regression/regex-backref-0.c
index 289be3b..3347685 100644
--- a/src/regression/regex-backref-0.c
+++ b/src/regression/regex-backref-0.c
@@ -1,9 +1,9 @@
 // \0 is not a valid backref, it is undefined by the standard
 // we treat such cases as literal char
 #include <regex.h>
-#include "test.h"
+#include <uk/test.h>
 
-int main(void)
+UK_TESTCASE(uk_libc_testsuite, regex_backref_tests)
 {
 	char buf[200];
 	char pat[] = "a\\0";
@@ -11,16 +11,13 @@ int main(void)
 	int n;
 
 	n = regcomp(&r, pat, 0);
+	UK_TEST_EXPECT_ZERO(n);
 	if (n) {
 		regerror(n, &r, buf, sizeof buf);
-		t_error("regcomp(%s) returned %d (%s) wanted 0\n", pat, n, buf);
 	}
 	n = regexec(&r, "a0", 0, 0, 0);
+	UK_TEST_EXPECT_ZERO(n);
 	if (n) {
 		regerror(n, &r, buf, sizeof buf);
-		t_error("regexec(/%s/ ~ \"a0\") returned %d (%s), wanted 0\n",
-			pat, n, buf);
 	}
-
-	return t_status;
 }
-- 
2.25.1

