From 232092d247e60a9e616ce4c956d38510b6ebb256 Mon Sep 17 00:00:00 2001
From: Florin Postolache <florin.postolache80@gmail.com>
Date: Tue, 25 Oct 2022 10:05:57 +0300
Subject: [PATCH] Modify string_strcspn source to work with uktest

Signed-off-by: Florin Postolache <florin.postolache80@gmail.com>
---
 src/functional/string_strcspn.c | 9 +++------
 1 file changed, 3 insertions(+), 6 deletions(-)

diff --git a/src/functional/string_strcspn.c b/src/functional/string_strcspn.c
index 88df383..7278606 100644
--- a/src/functional/string_strcspn.c
+++ b/src/functional/string_strcspn.c
@@ -1,16 +1,15 @@
 #include <stddef.h>
 #include <string.h>
-#include "test.h"
+#include <uk/test.h>
 
 #define T(s, c, n) { \
 	char *p = s; \
 	char *q = c; \
 	size_t r = strcspn(p, q); \
-	if (r != n) \
-		t_error("strcspn(%s,%s) returned %lu, wanted %lu\n", #s, #c, (unsigned long)r, (unsigned long)(n)); \
+	UK_TEST_ASSERT((r ==n)); \
 }
 
-int main(void)
+UK_TESTCASE(uk_libc_testsuite, string_strcspn_tests)
 {
 	int i;
 	char a[128];
@@ -29,6 +28,4 @@ int main(void)
 	T("abc", a, 0)
 	T("\xff\x80 abc", a, 2)
 	T(s, "\xff", 254)
-
-	return t_status;
 }
-- 
2.25.1

